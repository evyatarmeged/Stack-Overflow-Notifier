<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
</head>
<body>
    <!-- This is how you load jQuery in Electron -->
    <script>window.$ = window.jQuery = require('../jquery.min');</script>

    <div id="query-interval" hidden></div>
    <div id="tags" hidden></div>
    <div id="username" hidden></div>
    <div id="password" hidden></div>
    <div id="driver" hidden></div>
    <script>

	    const remote = require('electron').remote,
            args = remote.process.argv,
            program = require('commander'),
            fs = require('fs'),
            yaml = require('js-yaml'),
            path = require('path');

	    program
            .version('0.1.1')
            .option('-i, --interval <n>')
            .option('-t, --tags [tags]')
            // Optional
            .option('-u, --username [username]')
            .option('-p, --password [password]')
            .option('-c, --config')
            .option('--show-config')
            .parse(args);

        let confPath = path.join(__dirname, '../../config.yaml');
        let stackUser, stackPassword;

        if (program.showConfig) {

        }

        if (program.config)  {
	        try {
		        let config = yaml.safeLoad(fs.readFileSync(confPath));
		        stackUser = config.username;
		        stackPassword = config.password
	        } catch (err) {
                process.stdout.write(`${err}\r\n`);
                window.close();
                process.exit(1)
	        }
        } else {
            stackUser = program.username;
            stackPassword = program.password;
        }

        const stackInterval = program.interval,
            stackTags = program.tags;

        $('#query-interval').text(stackInterval);
        $('#tags').text(stackTags);
        $('#username').text(stackUser);
        $('#password').text(stackPassword);

        if (stackUser && stackPassword) {
	        // Write the arguments to .yaml
	        fs.writeFileSync(confPath,
		        yaml.safeDump({username: stackUser, password: stackPassword}))
        }

    </script>
    <img id="sof" src="../images/sof.png" hidden>
    <img id="msg" src="../images/msg.png" hidden>
    <img id="trophy" src="../images/trophy.png" hidden>
    <script src="../inquirer.js"></script>
</body>
</html>
